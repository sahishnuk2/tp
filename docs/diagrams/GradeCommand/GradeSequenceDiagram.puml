@startuml
!include ../style.puml
skinparam ArrowFontStyle plain
skinparam defaultFontSize 18
skinparam ArrowFontSize 18
skinparam ParticipantFontSize 18
skinparam NoteFontSize 18
skinparam BoxFontSize 18

' --- Compact layout tweaks ---
skinparam ParticipantPadding 5
skinparam BoxPadding 5
skinparam ArrowThickness 1
skinparam ArrowColor Black
skinparam LifelineStrategy solid
skinparam LifelineStroke 1
skinparam SequenceMessageAlign center
skinparam SequenceLifeLineBorderColor Black
skinparam SequenceLifeLineBorderThickness 0.5
skinparam SequenceActorBorderThickness 0.5
skinparam ParticipantMargin 5
skinparam ParticipantSpacing 40
skinparam SequenceDiagramPadding 5
skinparam SequenceMessagePadding 3
skinparam SequenceBoxBorderThickness 0.5
skinparam SequenceGroupBorderThickness 0.5
skinparam SequenceGroupPadding 3
skinparam SequenceDividerFontSize 16
skinparam MaxMessageSize 100

box Logic LOGIC_COLOR_T1
participant "logic:LogicManager" as LogicManager LOGIC_COLOR
participant "parser:AddressBookParser" as AddressBookParser LOGIC_COLOR
participant "command:GradeCommand" as GradeCommand LOGIC_COLOR
participant "r:CommandResult" as CommandResult LOGIC_COLOR
end box

box Model MODEL_COLOR_T1
participant "model:Model" as Model MODEL_COLOR
participant "person:Person" as Person MODEL_COLOR
participant "gradeMap:GradeMap" as GradeMap MODEL_COLOR
end box

[-> LogicManager : execute("grade 1:3 en/midterm s/y")
activate LogicManager

LogicManager -> AddressBookParser : parseCommand(args)
activate AddressBookParser

AddressBookParser -> AddressBookParser : parseGradeCommand(args)
activate AddressBookParser
create GradeCommand
AddressBookParser -> GradeCommand
AddressBookParser --> LogicManager : GradeCommand
deactivate AddressBookParser

LogicManager -> GradeCommand : execute(model)
activate GradeCommand

GradeCommand -> GradeCommand : super.execute(model)
activate GradeCommand

GradeCommand -> Model : getFilteredPersonList()
activate Model
Model --> GradeCommand : list of persons [1,2,3]
deactivate Model

loop For each person in the filtered person list
    GradeCommand -> GradeCommand : applyActionToPerson(model, person)
    activate GradeCommand

    GradeCommand -> GradeMap : markExamPassed("midterm")
    activate GradeMap
    GradeMap --> GradeCommand
    deactivate GradeMap

    GradeCommand -> Model : setPerson(old, updated)
    activate Model
    Model --> GradeCommand
    deactivate Model

    deactivate GradeCommand
end

GradeCommand -> GradeCommand : buildResult(updatedPersons)
activate GradeCommand

create CommandResult
GradeCommand -> CommandResult
activate CommandResult
CommandResult --> GradeCommand
deactivate CommandResult
deactivate GradeCommand

GradeCommand --> LogicManager : CommandResult
deactivate GradeCommand

[<-- LogicManager
deactivate LogicManager
@enduml
