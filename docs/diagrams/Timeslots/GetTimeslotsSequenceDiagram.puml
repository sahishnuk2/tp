@startuml
!include ../style.puml
skinparam ArrowFontStyle plain

box Logic LOGIC_COLOR_T1
participant ":LogicManager" as LogicManager LOGIC_COLOR
participant ":AddressBookParser" as AddressBookParser LOGIC_COLOR
participant ":GetTimeslotCommandParser" as GetTimeslotCommandParser LOGIC_COLOR
participant "c:GetTimeslotCommand" as GetTimeslotCommand LOGIC_COLOR
participant ":CommandResult" as CommandResult LOGIC_COLOR
end box

box Model MODEL_COLOR_T1
participant "m:Model" as Model MODEL_COLOR
end box


[-> LogicManager : execute("get-timeslots")
activate LogicManager

LogicManager -> AddressBookParser : parseCommand()
activate AddressBookParser

create GetTimeslotCommandParser
AddressBookParser -> GetTimeslotCommandParser
activate GetTimeslotCommandParser
AddressBookParser <-- GetTimeslotCommandParser
deactivate GetTimeslotCommandParser

AddressBookParser -> GetTimeslotCommandParser : parse()
activate GetTimeslotCommandParser

create GetTimeslotCommand
GetTimeslotCommandParser -> GetTimeslotCommand
activate GetTimeslotCommand

GetTimeslotCommand --> GetTimeslotCommandParser
deactivate GetTimeslotCommandParser
destroy GetTimeslotCommandParser

' End constructor activation for created command so execute(model) shows as a separate activation.
GetTimeslotCommand <-- GetTimeslotCommandParser
deactivate GetTimeslotCommand

AddressBookParser --> LogicManager : c
deactivate AddressBookParser

LogicManager -> GetTimeslotCommand : execute(model)
activate GetTimeslotCommand

GetTimeslotCommand -> Model : getTimeslots()
activate Model
Model --> GetTimeslotCommand : timeslot data
deactivate Model

GetTimeslotCommand -> GetTimeslotCommand : format ranges
create CommandResult
GetTimeslotCommand -> CommandResult : new CommandResult(message)
activate CommandResult
CommandResult --> GetTimeslotCommand
deactivate CommandResult

GetTimeslotCommand --> LogicManager : result
deactivate GetTimeslotCommand

' Persistence & UI scheduling intentionally omitted to keep diagram compact.
note right of LogicManager
  Persistence (saveAddressBook/saveTimeslots) and UI scheduling
  (Platform.runLater / TimeslotsWindow) omitted from this diagram.
end note

[<-- LogicManager
deactivate LogicManager

scale 1.5
@enduml
