@startuml
!include ../style.puml
skinparam ArrowFontStyle plain

box Logic LOGIC_COLOR_T1
participant ":LogicManager" as LogicManager LOGIC_COLOR
participant ":AddressBookParser" as AddressBookParser LOGIC_COLOR
participant ":UnblockTimeslotCommandParser" as UnblockTimeslotCommandParser LOGIC_COLOR
participant "c:UnblockTimeslotCommand" as UnblockTimeslotCommand LOGIC_COLOR
participant ":CommandResult" as CommandResult LOGIC_COLOR
end box

box Model MODEL_COLOR_T1
participant "m:Model" as Model MODEL_COLOR
end box

[-> LogicManager : execute("unblock-timeslot")
activate LogicManager

LogicManager -> AddressBookParser : parseCommand()
activate AddressBookParser

create UnblockTimeslotCommandParser
AddressBookParser -> UnblockTimeslotCommandParser
activate UnblockTimeslotCommandParser
AddressBookParser <-- UnblockTimeslotCommandParser
deactivate UnblockTimeslotCommandParser

AddressBookParser -> UnblockTimeslotCommandParser : parse()
activate UnblockTimeslotCommandParser

create UnblockTimeslotCommand
UnblockTimeslotCommandParser -> UnblockTimeslotCommand
activate UnblockTimeslotCommand

UnblockTimeslotCommand --> UnblockTimeslotCommandParser
deactivate UnblockTimeslotCommandParser
destroy UnblockTimeslotCommandParser

' End constructor activation for created command so execute(model) shows as a separate activation.
UnblockTimeslotCommand <-- UnblockTimeslotCommandParser
deactivate UnblockTimeslotCommand

AddressBookParser --> LogicManager : c
deactivate AddressBookParser

LogicManager -> UnblockTimeslotCommand : execute(model)
activate UnblockTimeslotCommand

UnblockTimeslotCommand -> Model : getTimeslots()
activate Model
Model --> UnblockTimeslotCommand : list
deactivate Model

UnblockTimeslotCommand -> UnblockTimeslotCommand : compute overlapping stored slots
UnblockTimeslotCommand -> Model : saveAddressBook()
activate Model
Model --> UnblockTimeslotCommand
deactivate Model

UnblockTimeslotCommand -> Model : removeTimeslot(s)
activate Model
Model --> UnblockTimeslotCommand
deactivate Model

UnblockTimeslotCommand -> Model : addTimeslot(t)
activate Model
Model --> UnblockTimeslotCommand
deactivate Model

create CommandResult
UnblockTimeslotCommand -> CommandResult : new CommandResult(message)
activate CommandResult
CommandResult --> UnblockTimeslotCommand
deactivate CommandResult

UnblockTimeslotCommand --> LogicManager : result
deactivate UnblockTimeslotCommand

' Persistence omitted for brevity.
note right of LogicManager : Persistence (saveAddressBook / saveTimeslots) omitted.

[<-- LogicManager
deactivate LogicManager

scale 1.5
@enduml
